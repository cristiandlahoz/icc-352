<VirtualHost *:80>
    ServerAdmin admin@admin.com
    ServerName ${DOMAIN}

    Redirect 301 / https://$DOMAIN/
</VirtualHost>

<VirtualHost *:443>
    ServerName ${DOMAIN}
    ServerAdmin admin@admin.com

    SSLEngine on
    SSLCertificateFile /etc/letsencrypt/live/$DOMAIN/cert.pem
    SSLCertificateKeyFile /etc/letsencrypt/live/$DOMAIN/privkey.pem
    SSLCertificateChainFile /etc/letsencrypt/live/$DOMAIN/chain.pem

    # Habilitar el proxy reverso hacia el puerto 7000
    ProxyPreserveHost On
    ProxyRequests Off
    ProxyPass / http://localhost:$PORT/
    ProxyPassReverse / http://localhost:$PORT/

    ErrorLog ${APACHE_LOG_DIR}/error.log
    TransferLog ${APACHE_LOG_DIR}/access.log
</VirtualHost>
